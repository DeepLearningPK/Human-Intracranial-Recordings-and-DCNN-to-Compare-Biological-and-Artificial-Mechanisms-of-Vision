library('wCorr')

# theta 50
x <- c(1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3)
y <- c(3, 4, 5, 6, 6, 7, 8, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 5, 6, 6, 6, 7, 7, 7, 8, 8, 8, 8, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8)
w <- c(0.1331, 0.1565, 0.17949999999999999, 0.1358, 0.109, 0.12330000000000001, 0.088400000000000006, 0.2802, 0.1303, 0.36549999999999999, 0.14230000000000001, 0.12920000000000001, 0.40349999999999997, 0.1449, 0.16159999999999999, 0.58590000000000009, 0.1774, 0.14649999999999999, 0.187, 0.43259999999999998, 0.14699999999999999, 0.2084, 0.14280000000000001, 0.55430000000000001, 0.13730000000000001, 0.11940000000000001, 0.47549999999999998, 0.1193, 0.10730000000000001, 0.088599999999999998, 0.073300000000000004, 0.097900000000000001, 0.086400000000000005, 0.115, 0.1474, 0.2009, 0.3367, 0.1605, 0.16869999999999999, 0.1691, 0.14530000000000001, 0.15179999999999999, 0.1391, 0.17030000000000001, 0.2535, 0.15329999999999999, 0.1547, 0.16650000000000001, 0.31610000000000005, 0.1321, 0.15179999999999999, 0.12690000000000001, 0.14169999999999999, 0.17230000000000001, 0.2036, 0.41800000000000004, 0.26070000000000004, 0.1431, 0.29320000000000002, 0.18060000000000001, 0.20130000000000001, 0.45610000000000001, 0.1434, 0.14050000000000001, 0.14879999999999999, 0.9375, 0.17299999999999999, 0.16839999999999999, 0.1421, 0.13289999999999999, 0.1242, 0.15640000000000001, 0.24110000000000001, 0.86109999999999998, 0.44850000000000001, 0.17849999999999999, 0.25600000000000001, 0.1206, 0.65749999999999997, 0.1018, 0.12920000000000001, 0.1459, 0.1242, 0.1132, 0.095100000000000004, 0.1298, 0.21260000000000001, 0.63449999999999995, 0.26119999999999999, 0.1202, 0.10639999999999999, 0.091800000000000007, 0.2009, 0.082100000000000006, 0.082299999999999998, 0.19359999999999999, 0.076700000000000004)
r <- weightedCorr(x, y, method="Spearman", weights=w)
t <- r * sqrt((length(x) - 2) / (1 - r^2))
dt(t, df=length(x) - 1)

# alpha 50
x <- c(1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3)
y <- c(4, 1, 1, 2, 2, 3, 3, 4, 4, 4, 5, 5, 6, 7, 8, 8, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8)
w <- c(0.14099999999999999, 0.158, 0.1532, 0.13550000000000001, 0.13569999999999999, 0.14069999999999999, 0.13919999999999999, 0.12759999999999999, 0.1749, 0.1787, 0.19359999999999999, 0.2069, 0.11749999999999999, 0.096600000000000005, 0.081100000000000005, 0.085199999999999998, 0.16470000000000001, 0.3231, 0.1986, 0.29910000000000003, 0.154, 0.25540000000000002, 0.17710000000000001, 0.1628, 0.16600000000000001, 0.26090000000000002, 0.18990000000000001, 0.113, 0.32389999999999997, 0.18390000000000001, 0.27190000000000003, 0.1358, 0.2167, 0.14130000000000001, 0.35619999999999996, 0.19220000000000001, 0.4335, 0.13059999999999999, 0.2359, 0.15260000000000001, 0.1142, 0.63629999999999998, 0.1183, 0.26290000000000002, 0.1157, 0.2545, 0.16600000000000001, 0.1172, 0.41490000000000005, 0.14979999999999999, 0.10489999999999999, 0.44930000000000003, 0.19950000000000001, 0.1061, 0.095399999999999999, 0.1132, 0.32430000000000003, 0.092200000000000004, 0.097600000000000006, 0.082600000000000007)
r <- weightedCorr(x, y, method="Spearman", weights=w)
t <- r * sqrt((length(x) - 2) / (1 - r^2))
dt(t, df=length(x) - 1)

# beta 50
x <- c(2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3)
y <- c(6, 7, 8, 1, 1, 2, 4, 5, 6, 6, 6, 6, 6, 7, 7, 7, 7)
w <- c(0.30590000000000001, 0.16869999999999999, 0.089099999999999999, 0.1386, 0.13400000000000001, 0.1242, 0.158, 0.1583, 0.2341, 0.1181, 0.2969, 0.16550000000000001, 0.18990000000000001, 0.19189999999999999, 0.2288, 0.13189999999999999, 0.13189999999999999)
r <- weightedCorr(x, y, method="Spearman", weights=w)
t <- r * sqrt((length(x) - 2) / (1 - r^2))
dt(t, df=length(x) - 1)

# lg 50
x <- c(0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3)
y <- c(0, 1, 2, 3, 4, 5, 0, 1, 3, 4, 5, 1, 2, 2, 3, 3, 4, 4, 5, 5, 8, 8, 1, 2, 3, 4, 4, 5, 6, 6, 6, 7, 7, 8, 8, 8)
w <- c(0.1411, 0.155, 0.16800000000000001, 0.1484, 0.1396, 0.14069999999999999, 0.1152, 0.1822, 0.13200000000000001, 0.26239999999999997, 0.14080000000000001, 0.1361, 0.1295, 0.12130000000000001, 0.1275, 0.1181, 0.13650000000000001, 0.1293, 0.1492, 0.1406, 0.075300000000000006, 0.072499999999999995, 0.1532, 0.12740000000000001, 0.13669999999999999, 0.12039999999999999, 0.1411, 0.1656, 0.11, 0.16850000000000001, 0.33320000000000005, 0.1542, 0.24820000000000003, 0.076899999999999996, 0.087099999999999997, 0.079500000000000001)
r <- weightedCorr(x, y, method="Spearman", weights=w)
t <- r * sqrt((length(x) - 2) / (1 - r^2))
dt(t, df=length(x) - 1)

# hg 50
x <- c(0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3)
y <- c(0, 1, 2, 3, 4, 4, 5, 5, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 8, 8, 8, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 6, 6, 6, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8)
w <- c(0.12, 0.16500000000000001, 0.14000000000000001, 0.1424, 0.28049999999999997, 0.1447, 0.30410000000000004, 0.15079999999999999, 0.151, 0.1714, 0.1241, 0.37119999999999997, 0.19919999999999999, 0.14360000000000001, 0.1278, 0.32679999999999998, 0.2487, 0.1215, 0.26249999999999996, 0.10249999999999999, 0.3634, 0.16039999999999999, 0.15379999999999999, 0.11550000000000001, 0.2959, 0.13070000000000001, 0.40780000000000005, 0.29759999999999998, 0.1268, 0.1588, 0.25850000000000001, 0.39480000000000004, 0.30530000000000002, 0.1643, 0.095399999999999999, 0.093899999999999997, 0.12640000000000001, 0.10680000000000001, 0.14979999999999999, 0.13830000000000001, 0.14599999999999999, 0.19059999999999999, 0.12609999999999999, 0.2596, 0.11990000000000001, 0.1176, 0.17019999999999999, 0.1166, 0.13370000000000001, 0.25540000000000002, 0.13769999999999999, 0.1739, 0.15359999999999999, 0.2959, 0.3049, 0.2185, 0.29920000000000002, 0.2989, 0.33330000000000004, 0.22950000000000001, 0.11269999999999999, 0.55590000000000006, 0.2137, 0.1193, 0.46319999999999995, 0.085099999999999995, 0.17829999999999999, 0.094, 0.092399999999999996, 0.22500000000000001, 0.072999999999999995, 0.095699999999999993, 0.094700000000000006, 0.080699999999999994, 0.091700000000000004, 0.12089999999999999, 0.1203, 0.18840000000000001, 0.12640000000000001, 0.1565, 0.13869999999999999, 0.13830000000000001, 0.1784, 0.13370000000000001, 0.14810000000000001, 0.20580000000000001, 0.12939999999999999, 0.25290000000000001, 0.1164, 0.12620000000000001, 0.1236, 0.1202, 0.2198, 0.13700000000000001, 0.1187, 0.28449999999999998, 0.1237, 0.1389, 0.115, 0.24790000000000001, 0.2455, 0.2913, 0.1394, 0.3135, 0.11559999999999999, 0.1171, 0.13189999999999999, 0.1144, 0.27559999999999996, 0.2621, 0.309, 0.30220000000000002, 0.12709999999999999, 0.13469999999999999, 0.1429, 0.62670000000000003, 0.18079999999999999, 0.14549999999999999, 0.60990000000000011, 0.29720000000000002, 0.65690000000000004, 0.14399999999999999, 0.13139999999999999, 0.4929, 0.2344, 0.0901, 0.34599999999999997, 0.068000000000000005, 0.084599999999999995, 0.24249999999999999, 0.065600000000000006, 0.17269999999999999)
r <- weightedCorr(x, y, method="Spearman", weights=w)
t <- r * sqrt((length(x) - 2) / (1 - r^2))
dt(t, df=length(x) - 1)

# theta 150
x <- c(1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3)
y <- c(1, 4, 6, 6, 6, 7, 7, 7, 1, 2, 3, 4, 4, 4, 4, 5, 5, 5, 5, 5, 6, 6, 6, 6, 7, 7, 7, 7, 7, 8, 8, 8, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8)
w <- c(0.15870000000000001, 0.13739999999999999, 0.11559999999999999, 0.1537, 0.13320000000000001, 0.1147, 0.1331, 0.1169, 0.41830000000000001, 0.3679, 0.41120000000000001, 0.14050000000000001, 0.57020000000000004, 0.14030000000000001, 0.1404, 0.14380000000000001, 0.57819999999999994, 0.1444, 0.13769999999999999, 0.16370000000000001, 0.1134, 0.1164, 0.1293, 0.1202, 0.3029, 0.096000000000000002, 0.1077, 0.1057, 0.096600000000000005, 0.073999999999999996, 0.086999999999999994, 0.082600000000000007, 0.1179, 0.1517, 0.30940000000000001, 0.1734, 0.21260000000000001, 0.1336, 0.1331, 0.15590000000000001, 0.12690000000000001, 0.13769999999999999, 0.14169999999999999, 0.13650000000000001, 0.1507, 0.1328, 0.13950000000000001, 0.13550000000000001, 0.1484, 0.15490000000000001, 0.126, 0.1424, 0.15129999999999999, 0.3201, 0.14430000000000001, 0.16109999999999999, 0.16350000000000001, 0.214, 0.17319999999999999, 0.152, 0.14660000000000001, 0.16209999999999999, 0.32419999999999999, 0.15379999999999999, 0.15140000000000001, 0.16850000000000001, 0.22839999999999999, 0.17369999999999999, 0.17030000000000001, 0.32750000000000001, 0.1217, 0.16139999999999999, 0.14949999999999999, 0.1203, 0.13009999999999999, 0.14680000000000001, 0.13070000000000001, 0.11849999999999999, 0.77190000000000003, 0.33260000000000001, 0.13339999999999999, 0.1149, 0.1028, 0.38779999999999998, 0.13969999999999999, 0.13020000000000001, 0.20619999999999999, 0.093799999999999994, 0.1351, 0.1203, 0.1067, 0.50040000000000007, 0.26000000000000001, 0.10340000000000001, 0.087599999999999997, 0.1696, 0.1169, 0.17049999999999998, 0.075800000000000006, 0.077399999999999997)
r <- weightedCorr(x, y, method="Spearman", weights=w)
t <- r * sqrt((length(x) - 2) / (1 - r^2))
dt(t, df=length(x) - 1)

# alpha 150
x <- c(1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3)
y <- c(6, 7, 4, 5, 6, 7, 0, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 6, 7, 7, 7, 7, 8)
w <- c(0.11799999999999999, 0.1163, 0.12540000000000001, 0.15140000000000001, 0.11119999999999999, 0.097799999999999998, 0.15140000000000001, 0.1585, 0.12770000000000001, 0.1336, 0.12709999999999999, 0.1249, 0.1305, 0.12559999999999999, 0.1603, 0.29270000000000002, 0.35050000000000003, 0.13450000000000001, 0.26770000000000005, 0.21279999999999999, 0.105, 0.096299999999999997, 0.20710000000000001, 0.076399999999999996)
r <- weightedCorr(x, y, method="Spearman", weights=w)
t <- r * sqrt((length(x) - 2) / (1 - r^2))
dt(t, df=length(x) - 1)

# beta 150
x <- c(0, 2, 2, 2, 3, 3)
y <- c(1, 6, 7, 8, 6, 7)
w <- c(0.15920000000000001, 0.1648, 0.14319999999999999, 0.075600000000000001, 0.12180000000000001, 0.10929999999999999)
r <- weightedCorr(x, y, method="Spearman", weights=w)
t <- r * sqrt((length(x) - 2) / (1 - r^2))
dt(t, df=length(x) - 1)

# lg 150
x <- c(0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3)
y <- c(0, 1, 2, 3, 4, 5, 5, 0, 1, 2, 3, 3, 4, 5, 5, 6, 7, 8, 0, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 6, 7, 8, 8, 8, 1, 1, 2, 3, 3, 4, 4, 4, 5, 5, 5, 6, 6, 6, 6, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8)
w <- c(0.13489999999999999, 0.13950000000000001, 0.17150000000000001, 0.14829999999999999, 0.14099999999999999, 0.13009999999999999, 0.14810000000000001, 0.15110000000000001, 0.36870000000000003, 0.3266, 0.1169, 0.33560000000000001, 0.32789999999999997, 0.122, 0.29430000000000001, 0.1363, 0.11609999999999999, 0.071599999999999997, 0.1119, 0.1807, 0.1149, 0.2858, 0.1237, 0.1134, 0.30030000000000001, 0.1358, 0.13420000000000001, 0.12520000000000001, 0.36609999999999998, 0.15379999999999999, 0.14910000000000001, 0.12520000000000001, 0.373, 0.15620000000000001, 0.1128, 0.10539999999999999, 0.084000000000000005, 0.072400000000000006, 0.1668, 0.15890000000000001, 0.1575, 0.13220000000000001, 0.1211, 0.13039999999999999, 0.152, 0.13750000000000001, 0.1293, 0.1201, 0.16350000000000001, 0.12509999999999999, 0.1797, 0.1182, 0.37619999999999998, 0.15720000000000001, 0.14560000000000001, 0.1101, 0.30259999999999998, 0.13120000000000001, 0.0974, 0.1028, 0.1416, 0.072499999999999995, 0.1678, 0.13940000000000002, 0.079500000000000001, 0.076899999999999996)
r <- weightedCorr(x, y, method="Spearman", weights=w)
t <- r * sqrt((length(x) - 2) / (1 - r^2))
dt(t, df=length(x) - 1)

# hg 150
x <- c(0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3)
y <- c(2, 3, 4, 4, 5, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 7, 8, 8, 8, 8, 8, 8, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 6, 6, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 0, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8)
w <- c(0.1424, 0.13120000000000001, 0.27800000000000002, 0.1186, 0.31759999999999999, 0.12909999999999999, 0.23549999999999999, 0.15740000000000001, 0.31730000000000003, 0.1333, 0.42369999999999997, 0.16919999999999999, 0.1176, 0.2833, 0.33399999999999996, 0.11, 0.1641, 0.2445, 0.3211, 0.1128, 0.36560000000000004, 0.27010000000000001, 0.19550000000000001, 0.2918, 0.34939999999999999, 0.1459, 0.1459, 0.41980000000000001, 0.16500000000000001, 0.2094, 0.33379999999999999, 0.32840000000000003, 0.13700000000000001, 0.43710000000000004, 0.089899999999999994, 0.22410000000000002, 0.16270000000000001, 0.096199999999999994, 0.094100000000000003, 0.082699999999999996, 0.090800000000000006, 0.1072, 0.30780000000000002, 0.38590000000000002, 0.20380000000000001, 0.30530000000000002, 0.32569999999999999, 0.30049999999999999, 0.12620000000000001, 0.31520000000000004, 0.11799999999999999, 0.36890000000000001, 0.31740000000000002, 0.12540000000000001, 0.14829999999999999, 0.72299999999999998, 0.4572, 0.37370000000000003, 0.15740000000000001, 0.1191, 0.28339999999999999, 0.31620000000000004, 0.47060000000000002, 0.36929999999999996, 0.1386, 0.3508, 0.21909999999999999, 0.31789999999999996, 0.089300000000000004, 0.1169, 0.20269999999999999, 0.1031, 0.2364, 0.36250000000000004, 0.083699999999999997, 0.37760000000000005, 0.3165, 0.076499999999999999, 0.10059999999999999, 0.069599999999999995, 0.066500000000000004, 0.1358, 0.070000000000000007, 0.10929999999999999, 0.37430000000000002, 0.1429, 0.14230000000000001, 0.41659999999999997, 0.1125, 0.12939999999999999, 0.1157, 0.124, 0.1084, 0.41949999999999998, 0.1221, 0.11749999999999999, 0.1361, 0.12089999999999999, 0.1201, 0.12280000000000001, 0.4672, 0.14990000000000001, 0.121, 0.2666, 0.13869999999999999, 0.11650000000000001, 0.13, 0.1176, 0.4874, 0.17180000000000001, 0.13289999999999999, 0.14330000000000001, 1.2128000000000001, 0.36870000000000003, 0.35589999999999999, 0.095299999999999996, 0.1142, 0.5717000000000001, 0.105, 0.48380000000000001, 0.085800000000000001, 1.1545000000000001, 0.31020000000000003, 0.40720000000000001, 0.097000000000000003, 0.21839999999999998, 0.46679999999999999, 0.098699999999999996, 0.43069999999999997, 0.080600000000000005, 0.1009, 0.090399999999999994, 0.98010000000000008, 0.075399999999999995, 0.1331, 0.071900000000000006, 0.2888, 0.1774, 0.251, 0.073499999999999996, 0.063700000000000007, 0.069599999999999995, 0.39929999999999999, 0.31109999999999999)
r <- weightedCorr(x, y, method="Spearman", weights=w)
t <- r * sqrt((length(x) - 2) / (1 - r^2))
dt(t, df=length(x) - 1)

# theta 250
x <- c(0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3)
y <- c(5, 1, 2, 3, 4, 5, 6, 7, 7, 8, 0, 0, 1, 2, 2, 3, 3, 4, 5, 5, 6, 7, 8, 1, 1, 1, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5, 6, 6, 7, 7)
w <- c(0.12989999999999999, 0.44120000000000004, 0.18160000000000001, 0.30270000000000002, 0.46260000000000001, 0.3589, 0.23830000000000001, 0.18279999999999999, 0.1023, 0.1535, 0.1116, 0.26239999999999997, 0.371, 0.13719999999999999, 0.1424, 0.12720000000000001, 0.1542, 0.18920000000000001, 0.1358, 0.19839999999999999, 0.17999999999999999, 0.1406, 0.075399999999999995, 0.35970000000000002, 0.16969999999999999, 0.1762, 0.1479, 0.1263, 0.1376, 0.12770000000000001, 0.13800000000000001, 0.13159999999999999, 0.1676, 0.14879999999999999, 0.1351, 0.16220000000000001, 0.14330000000000001, 0.13689999999999999, 0.18459999999999999, 0.1017, 0.1381)
r <- weightedCorr(x, y, method="Spearman", weights=w)
t <- r * sqrt((length(x) - 2) / (1 - r^2))
dt(t, df=length(x) - 1)

# alpha 250
x <- c(0, 1, 1, 1, 2, 2, 2, 3, 3, 3)
y <- c(6, 1, 6, 7, 5, 6, 6, 0, 6, 6)
w <- c(0.1105, 0.1406, 0.23039999999999999, 0.1138, 0.1527, 0.11, 0.24460000000000001, 0.13070000000000001, 0.1202, 0.1101)
r <- weightedCorr(x, y, method="Spearman", weights=w)
t <- r * sqrt((length(x) - 2) / (1 - r^2))
dt(t, df=length(x) - 1)

# beta 250
x <- c(0)
y <- c(1)
w <- c(0.152)
r <- weightedCorr(x, y, method="Spearman", weights=w)
t <- r * sqrt((length(x) - 2) / (1 - r^2))
dt(t, df=length(x) - 1)

# lg 250
x <- c(0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3)
y <- c(1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 6, 7, 0, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5, 5, 6, 7, 8, 8, 8, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 6, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8)
w <- c(0.28559999999999997, 0.1226, 0.1265, 0.1346, 0.13900000000000001, 0.1482, 0.33929999999999999, 0.25569999999999998, 0.27460000000000001, 0.27879999999999999, 0.12180000000000001, 0.1089, 0.1191, 0.31909999999999999, 0.13009999999999999, 0.17519999999999999, 0.26900000000000002, 0.14169999999999999, 0.1148, 0.14899999999999999, 0.29769999999999996, 0.13919999999999999, 0.1246, 0.2717, 0.32800000000000001, 0.30790000000000001, 0.28800000000000003, 0.29630000000000001, 0.31390000000000001, 0.154, 0.12720000000000001, 0.11119999999999999, 0.078600000000000003, 0.069500000000000006, 0.25319999999999998, 0.124, 0.1363, 0.1678, 0.1221, 0.13539999999999999, 0.1464, 0.1391, 0.16450000000000001, 0.15210000000000001, 0.16750000000000001, 0.17419999999999999, 0.26800000000000002, 0.3579, 0.28900000000000003, 0.086400000000000005, 0.25119999999999998, 0.29730000000000001, 0.2442, 0.078100000000000003, 0.0877, 0.16389999999999999, 0.16930000000000001, 0.068000000000000005, 0.090200000000000002, 0.1053, 0.066400000000000001)
r <- weightedCorr(x, y, method="Spearman", weights=w)
t <- r * sqrt((length(x) - 2) / (1 - r^2))
dt(t, df=length(x) - 1)

# hg 250
x <- c(0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3)
y <- c(2, 3, 4, 4, 5, 1, 1, 1, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 7, 8, 8, 8, 8, 8, 8, 8, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 6, 6, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 5, 5, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8)
w <- c(0.13669999999999999, 0.122, 0.1507, 0.1227, 0.1593, 0.1454, 0.1673, 0.1613, 0.1545, 0.26629999999999998, 0.1145, 0.1361, 0.1318, 0.1263, 0.28859999999999997, 0.30930000000000002, 0.14999999999999999, 0.25609999999999999, 0.16439999999999999, 0.16819999999999999, 0.13120000000000001, 0.19500000000000001, 0.1714, 0.14499999999999999, 0.17780000000000001, 0.088599999999999998, 0.1943, 0.067400000000000002, 0.094100000000000003, 0.086900000000000005, 0.074999999999999997, 0.075899999999999995, 0.067500000000000004, 0.23580000000000001, 0.1668, 0.31169999999999998, 0.34499999999999997, 0.14630000000000001, 0.26129999999999998, 0.30720000000000003, 0.15529999999999999, 0.42349999999999999, 0.32269999999999999, 0.1671, 0.47959999999999997, 0.39039999999999997, 0.11600000000000001, 0.1391, 0.12889999999999999, 0.1706, 0.29270000000000002, 0.4113, 0.14299999999999999, 0.11020000000000001, 0.1244, 0.1026, 0.095000000000000001, 0.13189999999999999, 0.1048, 0.088700000000000001, 0.21560000000000001, 0.083000000000000004, 0.43209999999999998, 0.27140000000000003, 0.072700000000000001, 0.067699999999999996, 0.0683, 0.12790000000000001, 0.070099999999999996, 0.1105, 0.109, 0.1275, 0.1225, 0.1169, 0.1055, 0.33760000000000001, 0.35550000000000004, 0.1298, 0.1205, 0.37490000000000001, 0.1069, 0.12130000000000001, 0.1173, 0.37609999999999999, 0.1363, 0.2324, 0.36649999999999999, 0.12709999999999999, 0.25659999999999999, 0.73150000000000004, 0.16619999999999999, 0.33119999999999999, 0.45540000000000003, 0.83899999999999997, 0.1346, 0.39729999999999999, 0.089300000000000004, 0.38350000000000001, 0.20190000000000002, 0.16300000000000001, 0.73980000000000001, 0.16389999999999999, 0.080799999999999997, 0.28470000000000001, 0.072700000000000001, 0.21860000000000002, 0.3407, 0.058599999999999999, 0.29660000000000003)
r <- weightedCorr(x, y, method="Spearman", weights=w)
t <- r * sqrt((length(x) - 2) / (1 - r^2))
dt(t, df=length(x) - 1)


