import numpy as np
from matplotlib import pylab as plt
import matplotlib.cm as cm

# prepare grid
nareas = 9
nfreqs = 5
ntimes = 3
x = []
n = 0.0
for a in range(nareas):
    for f in range(nfreqs):
        n += 1.0
        x.append(n)
    n += float(1.3)
x = np.tile(x, ntimes)
y = np.ravel([[t] * nareas * nfreqs for t in np.arange(ntimes, 0, -1)])
d = np.ones(ntimes * nareas * nfreqs)
size = d * 400

# set data
#volume = np.array([0.0071, 0.0000, 0.0000, 0.1987, 0.0743, 0.0496, 0.1032, 0.0303, 0.3134, 0.2228, 0.0765, 0.1006, 0.0138, 0.2698, 0.2011, 0.1248, 0.1030, 0.0000, 0.3158, 0.2344, 0.1708, 0.3085, 0.0176, 0.3968, 0.3684, 0.1881, 0.1557, 0.0176, 0.3314, 0.3701, 0.2472, 0.1164, 0.2646, 0.0874, 0.1130, 0.1749, 0.0791, 0.1604, 0.0575, 0.1118, 0.0758, 0.0482, 0.0445, 0.0841, 0.1061, 0.0034, 0.0116, 0.0000, 0.1137, 0.0326, 0.0900, 0.0122, 0.1592, 0.1919, 0.1226, 0.0467, 0.0201, 0.0000, 0.2354, 0.1679, 0.0578, 0.0194, 0.0000, 0.2611, 0.2159, 0.1427, 0.0824, 0.0000, 0.2773, 0.3698, 0.1210, 0.1105, 0.0000, 0.3663, 0.3060, 0.2094, 0.2315, 0.2866, 0.1028, 0.0999, 0.2008, 0.2130, 0.2525, 0.0875, 0.1193, 0.0352, 0.0059, 0.0756, 0.1232, 0.1949, 0.0623, 0.0436, 0.0000, 0.0696, 0.0295, 0.2509, 0.0469, 0.1520, 0.3386, 0.0883, 0.1221, 0.0000, 0.0000, 0.2311, 0.1303, 0.1839, 0.0000, 0.0000, 0.2571, 0.1907, 0.1886, 0.0000, 0.0000, 0.2737, 0.3407, 0.3010, 0.0509, 0.0000, 0.1687, 0.2193, 0.1236, 0.3823, 0.0000, 0.1143, 0.0570, 0.1147, 0.0379, 0.0000, 0.1060, 0.0792, 0.0433, 0.0000, 0.0000, 0.0954, 0.1970])
volume = np.array([0.0071, 0.0000, 0.0000, 0.1987, 0.0743, 0.0702, 0.1032, 0.0303, 0.3134, 0.2228, 0.0866, 0.1006, 0.0138, 0.2698, 0.2011, 0.1434, 0.1030, 0.0000, 0.3158, 0.2344, 0.1905, 0.3235, 0.0176, 0.3968, 0.3684, 0.2080, 0.1557, 0.0176, 0.3314, 0.3701, 0.3858, 0.2878, 0.4263, 0.2221, 0.1130, 0.2812, 0.2211, 0.2933, 0.1113, 0.1118, 0.0996, 0.0659, 0.0915, 0.0841, 0.1061, 0.0034, 0.0116, 0.0000, 0.1212, 0.0326, 0.1172, 0.0122, 0.1592, 0.2103, 0.1226, 0.0576, 0.0201, 0.0000, 0.2518, 0.1679, 0.0788, 0.0194, 0.0000, 0.2837, 0.2159, 0.1597, 0.0197, 0.0000, 0.2937, 0.3698, 0.1368, 0.0348, 0.0000, 0.3872, 0.3060, 0.3240, 0.3572, 0.3614, 0.1375, 0.2310, 0.2939, 0.3054, 0.3551, 0.1747, 0.1991, 0.0642, 0.0600, 0.1613, 0.2164, 0.2254, 0.1164, 0.0654, 0.0000, 0.0844, 0.0295, 0.0692, 0.0000, 0.1520, 0.2359, 0.0883, 0.2021, 0.0000, 0.0000, 0.2002, 0.1303, 0.2223, 0.0000, 0.0000, 0.2282, 0.1907, 0.1282, 0.0000, 0.0000, 0.2558, 0.3407, 0.2302, 0.0000, 0.0000, 0.0989, 0.2193, 0.1202, 0.0601, 0.0000, 0.1057, 0.1253, 0.1503, 0.0000, 0.0000, 0.1324, 0.1819, 0.0000, 0.0000, 0.0000, 0.1296, 0.2812])
size = volume
#size = volume / 10.0
#size[size > 1.0] = 1.0
#specificity = np.array([0.0514, 0.0000, 0.0000, 1.0000, 0.5365, 0.3017, 0.2883, 1.0000, 1.0000, 1.0000, 0.4258, 1.0000, 0.1031, 0.6799, 1.0000, 0.5277, 0.3184, 0.0000, 1.0000, 0.6878, 0.5869, 0.4571, 0.1092, 0.6125, 0.7681, 0.6057, 0.5012, 0.0901, 0.5182, 0.6804, 0.2633, 0.2757, 0.2842, 0.2692, 1.0000, 0.2096, 0.2097, 0.2074, 0.3726, 0.5779, 0.3849, 0.2801, 0.2739, 1.0000, 0.7309, 0.0076, 0.0249, 0.0000, 1.0000, 0.0695, 0.4086, 0.0444, 1.0000, 1.0000, 0.2822, 0.2268, 0.1630, 0.0000, 0.6607, 0.4099, 0.3291, 0.1583, 0.0000, 0.6121, 0.4308, 0.4341, 1.0000, 0.0000, 0.6840, 0.6652, 0.2609, 1.0000, 0.0000, 0.7360, 0.9095, 0.2270, 0.4772, 0.7930, 0.2859, 0.3702, 0.2510, 0.4105, 0.7111, 0.2138, 0.3493, 0.1211, 0.0276, 0.2580, 0.4328, 0.4402, 0.1274, 0.1253, 0.0000, 0.1566, 0.0301, 0.6986, 1.0000, 1.0000, 0.6888, 0.8576, 0.3946, 0.0000, 0.0000, 0.6544, 1.0000, 0.3723, 0.0000, 0.0000, 0.4974, 0.7617, 0.5178, 0.0000, 0.0000, 0.4941, 0.8164, 0.7734, 1.0000, 0.0000, 0.5123, 0.7512, 0.1193, 1.0000, 0.0000, 0.3709, 0.1525, 0.2124, 0.3798, 0.0000, 0.2986, 0.2044, 0.0845, 0.0000, 0.0000, 0.4534, 0.3240])
specificity = np.array([0.0514, 0.0000, 0.0000, 1.0000, 0.5365, 0.4271, 0.2883, 1.0000, 1.0000, 1.0000, 0.4820, 1.0000, 0.1031, 0.6799, 1.0000, 0.6062, 0.3184, 0.0000, 1.0000, 0.6878, 0.6547, 0.4794, 0.1092, 0.6125, 0.7681, 0.6698, 0.5012, 0.0901, 0.5182, 0.6804, 0.4108, 0.6816, 0.4578, 0.6841, 1.0000, 0.3370, 0.5857, 0.3792, 0.7216, 0.5779, 0.5058, 0.3823, 0.5623, 1.0000, 0.7309, 0.0076, 0.0249, 0.0000, 1.0000, 0.0695, 0.4980, 0.0742, 1.0000, 1.0000, 0.2822, 0.2777, 1.0000, 0.0000, 0.6756, 0.4099, 0.4440, 1.0000, 0.0000, 0.6316, 0.4308, 0.4770, 1.0000, 0.0000, 0.6963, 0.6652, 0.2982, 1.0000, 0.0000, 0.7466, 0.9095, 0.3807, 0.8449, 1.0000, 0.4140, 0.8563, 0.3731, 0.6767, 1.0000, 0.4524, 0.5828, 0.2206, 0.2822, 0.5505, 0.7508, 0.5091, 0.2411, 0.1769, 0.0000, 0.1839, 0.0301, 0.3900, 0.0000, 1.0000, 0.6066, 0.8576, 0.6504, 0.0000, 0.0000, 0.6212, 1.0000, 0.4886, 0.0000, 0.0000, 0.4676, 0.7617, 0.5428, 0.0000, 0.0000, 0.4772, 0.8164, 0.7230, 0.0000, 0.0000, 0.3810, 0.7512, 0.1446, 1.0000, 0.0000, 0.4062, 0.3354, 0.3336, 0.0000, 0.0000, 0.4214, 0.4694, 0.0000, 0.0000, 0.0000, 0.5863, 0.4625])

#volume = np.array([0.0000, 0.0000, 0.0000, 0.8928, 1.4475, 0.9256, 0.1410, 0.0000, 0.8326, 5.8732, 5.6444, 2.1244, 0.5637, 1.3359, 7.1778, 13.7623, 9.2540, 2.4021, 2.1020, 11.5212, 5.7216, 2.7679, 2.3907, 0.3771, 0.0000, 0.0000, 0.0000, 0.1592, 1.0134, 0.9878, 1.0633, 0.2343, 0.0000, 2.3671, 7.8881, 4.7884, 0.4858, 0.3836, 3.4907, 10.1596, 11.9626, 2.9826, 0.2311, 3.9263, 15.1208, 4.6860, 1.6082, 0.7892, 0.5241, 0.7241, 0.1299, 0.1105, 0.1520, 0.8083, 0.6914, 2.4239, 0.4848, 0.0000, 1.5273, 4.3102, 2.2254, 0.5073, 0.0000, 4.5790, 7.2807, 2.8330, 0.3610, 0.0000, 4.2523, 10.0000, 0.6803, 0.0000, 0.0000, 0.3902, 0.5105])
#size = volume / 10.0
#size[size > 1.0] = 1.0
#specificity = np.array([0.0000, 0.0000, 0.0000, -1.2091, 0.0166, 1.4144, 0.0000, 0.0000, -0.8027, -0.8382, 0.4999, -0.3386, 1.0000, -0.7805, 0.2885, 0.9900, 0.7724, 1.5380, 1.0392, 0.2870, 1.6812, 1.0000, 1.0000, 1.0000, 0.0000, 0.0000, 0.0000, -1.0000, -0.5014, 0.1491, 1.5757, 1.0000, 0.0000, -0.5403, -0.6489, 0.6768, 1.0000, 1.0000, -0.2053, -0.0327, 0.8761, 1.0004, 1.0000, 1.0138, 1.0463, 1.8326, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, -1.0000, -1.3472, -0.4849, -0.0478, 0.8953, 0.0000, -1.3269, -0.4344, -0.3530, 1.0000, 0.0000, -0.7545, -0.4334, -0.5582, 1.0000, 0.0000, 0.9247, 0.9905, -1.0251, 0.0000, 0.0000, 1.0000, 1.0000])
#print specificity.shape

# plot
plt.figure(figsize=(143.0, 6.25), dpi=600);
plt.scatter(x, y, s=size * 10000, c=specificity, cmap=cm.Reds);
plt.axis('off');
plt.savefig('dots_layer_specificty_and_volume.png', bbox_inches='tight');